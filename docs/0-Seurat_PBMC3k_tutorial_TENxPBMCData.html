<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Kevin Rue-Albrecht" />

<meta name="date" content="2019-07-04" />

<title>Seurat PBMC 3k tutorial using TENxPBMCData</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<link rel="stylesheet" href="www/scroll.css">

<script src="www/scroll.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">hancock</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Seurat PBMC 3k
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="0-Seurat_PBMC3k_tutorial_TENxPBMCData.html">Data</a>
    </li>
    <li>
      <a href="1-proportion_signature.html">Applying signatures</a>
    </li>
    <li>
      <a href="2-learn-signatures.html">Learning signatures</a>
    </li>
    <li>
      <a href="3-pairedTTests.html">Enrichment of Gene Signatures in Positive Markers</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Seurat PBMC 3k tutorial using TENxPBMCData</h1>
<h4 class="author">Kevin Rue-Albrecht</h4>
<h4 class="date">4 July 2019</h4>

</div>


<div id="overview" class="section level1">
<h1>Overview</h1>
<p>In this example, we use count data for 2,700 peripheral blood mononuclear cells (PBMC) obtained using the <a href="www.10xgenomics.com">10X Genomics</a> platform, and process it following the <a href="https://satijalab.org/seurat/v3.0/pbmc3k_tutorial.html">Guided Clustering Tutorial</a> of the <em><a href="https://CRAN.R-project.org/package=Seurat">Seurat</a></em> package.</p>
</div>
<div id="getting-the-data" class="section level1">
<h1>Getting the data</h1>
<p>First, fetch the data as a <em><a href="https://bioconductor.org/packages/3.10/SingleCellExperiment">SingleCellExperiment</a></em> object using the <em><a href="https://bioconductor.org/packages/3.10/TENxPBMCData">TENxPBMCData</a></em> package. The first time that the following code chunk is run, users should expect it to take additional time as it downloads data from the web and caches it on their local machine; subsequent evaluations of the same code chunk should only take a few seconds as the data set is then loaded from the local cache.</p>
<pre class="r"><code>library(TENxPBMCData)
tenx_pbmc3k &lt;- TENxPBMCData(dataset=&quot;pbmc3k&quot;)
colnames(tenx_pbmc3k) &lt;- paste0(&quot;Cell&quot;, seq_len(ncol(tenx_pbmc3k)))
tenx_pbmc3k</code></pre>
<pre><code>## class: SingleCellExperiment 
## dim: 32738 2700 
## metadata(0):
## assays(1): counts
## rownames(32738): ENSG00000243485 ENSG00000237613 ...
##   ENSG00000215616 ENSG00000215611
## rowData names(3): ENSEMBL_ID Symbol_TENx Symbol
## colnames(2700): Cell1 Cell2 ... Cell2699 Cell2700
## colData names(11): Sample Barcode ... Individual Date_published
## reducedDimNames(0):
## spikeNames(0):</code></pre>
</div>
<div id="preparing-the-data" class="section level1">
<h1>Preparing the data</h1>
<p>Next, prepare a sparse matrix that emulates the first section of the <a href="https://satijalab.org/seurat/v3.0/pbmc3k_tutorial.html">Guided Clustering Tutorial</a>.</p>
<pre class="r"><code>library(Matrix)
pbmc.data &lt;- as(counts(tenx_pbmc3k), &quot;Matrix&quot;)
pbmc.data &lt;- as(pbmc.data, &quot;dgTMatrix&quot;)</code></pre>
</div>
<div id="seurat---guided-clustering-tutorial" class="section level1">
<h1>Seurat - Guided Clustering Tutorial</h1>
<p>From here on, follow the <a href="https://satijalab.org/seurat/v3.0/pbmc3k_tutorial.html">Guided Clustering Tutorial</a> to the letter (code obtained on 2018-11-24).</p>
<pre class="r"><code>library(Seurat)
library(dplyr)
# Initialize the Seurat object with the raw (non-normalized data).  Keep all
# genes expressed in &gt;= 3 cells (~0.1% of the data). Keep all cells with at
# least 200 detected genes
pbmc &lt;- CreateSeuratObject(counts = pbmc.data, project = &quot;pbmc3k&quot;, min.cells = 3, min.features = 200)
pbmc</code></pre>
<pre><code>## An object of class Seurat 
## 13714 features across 2700 samples within 1 assay 
## Active assay: RNA (13714 features)</code></pre>
<pre class="r"><code># The [[ operator can add columns to object metadata. This is a great place to stash QC stats
pbmc[[&quot;percent.mt&quot;]] &lt;- PercentageFeatureSet(pbmc, pattern = &quot;^MT-&quot;)</code></pre>
<pre class="r"><code># Visualize QC metrics as a violin plot
VlnPlot(pbmc, features = c(&quot;nFeature_RNA&quot;, &quot;nCount_RNA&quot;, &quot;percent.mt&quot;), ncol = 3)</code></pre>
<pre><code>## Warning in SingleExIPlot(type = type, data = data[, x, drop = FALSE],
## idents = idents, : All cells have the same value of percent.mt.</code></pre>
<p><img src="0-Seurat_PBMC3k_tutorial_TENxPBMCData_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code># FeatureScatter is typically used to visualize feature-feature relationships, but can be used
# for anything calculated by the object, i.e. columns in object metadata, PC scores etc.

plot1 &lt;- FeatureScatter(pbmc, feature1 = &quot;nCount_RNA&quot;, feature2 = &quot;percent.mt&quot;)</code></pre>
<pre><code>## Warning in cor(x = data[, 1], y = data[, 2]): the standard deviation is
## zero</code></pre>
<pre class="r"><code>plot2 &lt;- FeatureScatter(pbmc, feature1 = &quot;nCount_RNA&quot;, feature2 = &quot;nFeature_RNA&quot;)
CombinePlots(plots = list(plot1, plot2))</code></pre>
<p><img src="0-Seurat_PBMC3k_tutorial_TENxPBMCData_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>pbmc &lt;- subset(pbmc, subset = nFeature_RNA &gt; 200 &amp; nFeature_RNA &lt; 2500 &amp; percent.mt &lt; 5)</code></pre>
<pre class="r"><code>pbmc &lt;- NormalizeData(pbmc, normalization.method = &quot;LogNormalize&quot;, scale.factor = 10000)</code></pre>
<pre class="r"><code>pbmc &lt;- FindVariableFeatures(pbmc, selection.method = &quot;vst&quot;, nfeatures = 2000)

# Identify the 10 most highly variable genes
top10 &lt;- head(VariableFeatures(pbmc), 10)

# plot variable features with and without labels
plot1 &lt;- VariableFeaturePlot(pbmc)
plot2 &lt;- LabelPoints(plot = plot1, points = top10, repel = TRUE)</code></pre>
<pre><code>## Warning: Using `as.character()` on a quosure is deprecated as of rlang 0.3.0.
## Please use `as_label()` or `as_name()` instead.
## This warning is displayed once per session.</code></pre>
<pre><code>## When using repel, set xnudge and ynudge to 0 for optimal results</code></pre>
<pre class="r"><code>CombinePlots(plots = list(plot1, plot2))</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<p><img src="0-Seurat_PBMC3k_tutorial_TENxPBMCData_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>all.genes &lt;- rownames(pbmc)
pbmc &lt;- ScaleData(pbmc, features = all.genes)</code></pre>
<pre><code>## Centering and scaling data matrix</code></pre>
<pre class="r"><code>pbmc &lt;- RunPCA(pbmc, features = VariableFeatures(object = pbmc))</code></pre>
<pre><code>## PC_ 1 
## Positive:  ENSG00000251562, ENSG00000227507, ENSG00000008517, ENSG00000168685, ENSG00000116824, ENSG00000166710, ENSG00000072818, ENSG00000172543, ENSG00000197540, ENSG00000164543 
##     ENSG00000198821, ENSG00000161570, ENSG00000196329, ENSG00000165272, ENSG00000145649, ENSG00000077984, ENSG00000009790, ENSG00000172005, ENSG00000171476, ENSG00000113088 
##     ENSG00000078596, ENSG00000136997, ENSG00000179144, ENSG00000134954, ENSG00000133134, ENSG00000157978, ENSG00000115085, ENSG00000145220, ENSG00000105374, ENSG00000139187 
## Negative:  ENSG00000101439, ENSG00000011600, ENSG00000204482, ENSG00000204472, ENSG00000087086, ENSG00000085265, ENSG00000090382, ENSG00000167996, ENSG00000163220, ENSG00000158869 
##     ENSG00000025708, ENSG00000197766, ENSG00000100097, ENSG00000143546, ENSG00000163131, ENSG00000100079, ENSG00000197249, ENSG00000066336, ENSG00000142089, ENSG00000197746 
##     ENSG00000126759, ENSG00000130066, ENSG00000216490, ENSG00000103187, ENSG00000163191, ENSG00000119655, ENSG00000030582, ENSG00000131981, ENSG00000084207, ENSG00000116701 
## PC_ 2 
## Positive:  ENSG00000105369, ENSG00000156738, ENSG00000100721, ENSG00000196735, ENSG00000179344, ENSG00000204287, ENSG00000247982, ENSG00000007312, ENSG00000196126, ENSG00000019582 
##     ENSG00000223865, ENSG00000204257, ENSG00000237541, ENSG00000104894, ENSG00000198502, ENSG00000231389, ENSG00000242574, ENSG00000132185, ENSG00000122986, ENSG00000227507 
##     ENSG00000095585, ENSG00000083454, ENSG00000254709, ENSG00000140968, ENSG00000133789, ENSG00000138639, ENSG00000072694, ENSG00000167641, ENSG00000163683, ENSG00000154102 
## Negative:  ENSG00000105374, ENSG00000077984, ENSG00000180644, ENSG00000145649, ENSG00000100453, ENSG00000137441, ENSG00000172543, ENSG00000115523, ENSG00000166710, ENSG00000159674 
##     ENSG00000100450, ENSG00000129277, ENSG00000203747, ENSG00000197540, ENSG00000161570, ENSG00000198821, ENSG00000143185, ENSG00000169583, ENSG00000196139, ENSG00000122862 
##     ENSG00000171476, ENSG00000196154, ENSG00000109861, ENSG00000075234, ENSG00000135046, ENSG00000163453, ENSG00000115738, ENSG00000008517, ENSG00000075624, ENSG00000143184 
## PC_ 3 
## Positive:  ENSG00000196735, ENSG00000105369, ENSG00000007312, ENSG00000179344, ENSG00000223865, ENSG00000019582, ENSG00000231389, ENSG00000156738, ENSG00000196126, ENSG00000198502 
##     ENSG00000204287, ENSG00000237541, ENSG00000100721, ENSG00000247982, ENSG00000242574, ENSG00000204257, ENSG00000104894, ENSG00000122986, ENSG00000132185, ENSG00000140968 
##     ENSG00000145287, ENSG00000095585, ENSG00000163683, ENSG00000166428, ENSG00000086730, ENSG00000133789, ENSG00000254709, ENSG00000083454, ENSG00000203747, ENSG00000137441 
## Negative:  ENSG00000163736, ENSG00000163737, ENSG00000168497, ENSG00000113140, ENSG00000127920, ENSG00000154146, ENSG00000169704, ENSG00000150681, ENSG00000101162, ENSG00000120885 
##     ENSG00000236304, ENSG00000180573, ENSG00000005961, ENSG00000010278, ENSG00000088726, ENSG00000171611, ENSG00000104267, ENSG00000111644, ENSG00000166681, ENSG00000108960 
##     ENSG00000161911, ENSG00000124491, ENSG00000184702, ENSG00000176783, ENSG00000130830, ENSG00000166091, ENSG00000272053, ENSG00000102804, ENSG00000101335, ENSG00000185245 
## PC_ 4 
## Positive:  ENSG00000196735, ENSG00000180573, ENSG00000163737, ENSG00000007312, ENSG00000105369, ENSG00000168497, ENSG00000163736, ENSG00000127920, ENSG00000113140, ENSG00000156738 
##     ENSG00000179344, ENSG00000019582, ENSG00000169704, ENSG00000223865, ENSG00000154146, ENSG00000150681, ENSG00000010278, ENSG00000236304, ENSG00000171611, ENSG00000120885 
##     ENSG00000104267, ENSG00000237541, ENSG00000100721, ENSG00000196126, ENSG00000231389, ENSG00000101162, ENSG00000204287, ENSG00000088726, ENSG00000247982, ENSG00000005961 
## Negative:  ENSG00000026025, ENSG00000168685, ENSG00000197956, ENSG00000143546, ENSG00000196154, ENSG00000008517, ENSG00000163220, ENSG00000197747, ENSG00000179144, ENSG00000170458 
##     ENSG00000172005, ENSG00000100079, ENSG00000165272, ENSG00000116824, ENSG00000162444, ENSG00000085265, ENSG00000082074, ENSG00000133574, ENSG00000090382, ENSG00000135046 
##     ENSG00000110077, ENSG00000163221, ENSG00000163191, ENSG00000110203, ENSG00000196329, ENSG00000204472, ENSG00000169429, ENSG00000186854, ENSG00000126709, ENSG00000251562 
## PC_ 5 
## Positive:  ENSG00000100453, ENSG00000105374, ENSG00000137441, ENSG00000115523, ENSG00000129277, ENSG00000077984, ENSG00000180644, ENSG00000143546, ENSG00000145649, ENSG00000159674 
##     ENSG00000100450, ENSG00000169583, ENSG00000172543, ENSG00000006075, ENSG00000143185, ENSG00000163220, ENSG00000100079, ENSG00000161570, ENSG00000075234, ENSG00000170458 
##     ENSG00000162444, ENSG00000196139, ENSG00000011600, ENSG00000163221, ENSG00000163453, ENSG00000110077, ENSG00000143184, ENSG00000084207, ENSG00000110203, ENSG00000197540 
## Negative:  ENSG00000227507, ENSG00000168685, ENSG00000026025, ENSG00000165272, ENSG00000115165, ENSG00000166165, ENSG00000172005, ENSG00000166927, ENSG00000180817, ENSG00000110958 
##     ENSG00000116824, ENSG00000224397, ENSG00000142512, ENSG00000172725, ENSG00000164111, ENSG00000102871, ENSG00000123416, ENSG00000189159, ENSG00000100292, ENSG00000082074 
##     ENSG00000131042, ENSG00000008517, ENSG00000146386, ENSG00000057608, ENSG00000009790, ENSG00000163399, ENSG00000169508, ENSG00000131507, ENSG00000133574, ENSG00000165629</code></pre>
<pre class="r"><code># Examine and visualize PCA results a few different ways
print(pbmc[[&quot;pca&quot;]], dims = 1:5, nfeatures = 5)</code></pre>
<pre><code>## PC_ 1 
## Positive:  ENSG00000251562, ENSG00000227507, ENSG00000008517, ENSG00000168685, ENSG00000116824 
## Negative:  ENSG00000101439, ENSG00000011600, ENSG00000204482, ENSG00000204472, ENSG00000087086 
## PC_ 2 
## Positive:  ENSG00000105369, ENSG00000156738, ENSG00000100721, ENSG00000196735, ENSG00000179344 
## Negative:  ENSG00000105374, ENSG00000077984, ENSG00000180644, ENSG00000145649, ENSG00000100453 
## PC_ 3 
## Positive:  ENSG00000196735, ENSG00000105369, ENSG00000007312, ENSG00000179344, ENSG00000223865 
## Negative:  ENSG00000163736, ENSG00000163737, ENSG00000168497, ENSG00000113140, ENSG00000127920 
## PC_ 4 
## Positive:  ENSG00000196735, ENSG00000180573, ENSG00000163737, ENSG00000007312, ENSG00000105369 
## Negative:  ENSG00000026025, ENSG00000168685, ENSG00000197956, ENSG00000143546, ENSG00000196154 
## PC_ 5 
## Positive:  ENSG00000100453, ENSG00000105374, ENSG00000137441, ENSG00000115523, ENSG00000129277 
## Negative:  ENSG00000227507, ENSG00000168685, ENSG00000026025, ENSG00000165272, ENSG00000115165</code></pre>
<pre class="r"><code>VizDimLoadings(pbmc, dims = 1:2, reduction = &quot;pca&quot;)</code></pre>
<p><img src="0-Seurat_PBMC3k_tutorial_TENxPBMCData_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>DimPlot(pbmc, reduction = &quot;pca&quot;)</code></pre>
<p><img src="0-Seurat_PBMC3k_tutorial_TENxPBMCData_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>DimHeatmap(pbmc, dims = 1, cells = 500, balanced = TRUE)</code></pre>
<p><img src="0-Seurat_PBMC3k_tutorial_TENxPBMCData_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>DimHeatmap(pbmc, dims = 1:15, cells = 500, balanced = TRUE)</code></pre>
<p><img src="0-Seurat_PBMC3k_tutorial_TENxPBMCData_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Small deviation from the tutorial. Skip the lengthy JackStraw computation.</p>
<pre class="r"><code>if (FALSE) {
    # NOTE: This process can take a long time for big datasets, comment out for expediency. More
    # approximate techniques such as those implemented in ElbowPlot() can be used to reduce
    # computation time
    pbmc &lt;- JackStraw(pbmc, num.replicate = 100)
    pbmc &lt;- ScoreJackStraw(pbmc, dims = 1:20)
    JackStrawPlot(pbmc, dims = 1:15)
}</code></pre>
<pre class="r"><code>ElbowPlot(pbmc)</code></pre>
<p><img src="0-Seurat_PBMC3k_tutorial_TENxPBMCData_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code>pbmc &lt;- FindNeighbors(pbmc, dims = 1:10)</code></pre>
<pre><code>## Computing nearest neighbor graph</code></pre>
<pre><code>## Computing SNN</code></pre>
<pre class="r"><code>pbmc &lt;- FindClusters(pbmc, resolution = 0.5)</code></pre>
<pre><code>## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck
## 
## Number of nodes: 2695
## Number of edges: 97555
## 
## Running Louvain algorithm...
## Maximum modularity in 10 random starts: 0.8746
## Number of communities: 9
## Elapsed time: 0 seconds</code></pre>
<pre class="r"><code># Look at cluster IDs of the first 5 cells
head(Idents(pbmc), 5)</code></pre>
<pre><code>## Cell1 Cell2 Cell3 Cell4 Cell5 
##     0     3     2     1     6 
## Levels: 0 1 2 3 4 5 6 7 8</code></pre>
<pre class="r"><code># If you haven&#39;t installed UMAP, you can do so via reticulate::py_install(packages =
# &#39;umap-learn&#39;)
pbmc &lt;- RunUMAP(pbmc, dims = 1:10)
# note that you can set `label = TRUE` or use the LabelClusters function to help label
# individual clusters
DimPlot(pbmc, reduction = &quot;umap&quot;)</code></pre>
<p><img src="0-Seurat_PBMC3k_tutorial_TENxPBMCData_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Save the <code>seurat</code> object</p>
<pre class="r"><code>saveRDS(pbmc, file=&quot;pbmc3k_tutorial.rds&quot;)</code></pre>
<p>Save the original <code>SingleCellExperiment</code> object, after:</p>
<ul>
<li>removing the cells excluded by quality metrics during the Seurat workflow</li>
<li>adding the cluster assignments</li>
<li>adding the PCA and t-SNE dimensionality reduction results</li>
</ul>
<pre class="r"><code>tenx_pbmc3k &lt;- tenx_pbmc3k[, colnames(pbmc)]
colData(tenx_pbmc3k)[[&quot;seurat.ident&quot;]] &lt;- Idents(pbmc)
reducedDim(tenx_pbmc3k, &quot;PCA&quot;) &lt;- Embeddings(pbmc, reduction = &quot;pca&quot;)
reducedDim(tenx_pbmc3k, &quot;UMAP&quot;) &lt;- Embeddings(pbmc, reduction = &quot;umap&quot;)
colnames(tenx_pbmc3k) &lt;- NULL # remove the superfluous dummy cell names before exporting
saveRDS(tenx_pbmc3k, file=&quot;pbmc3k_tutorial.sce.rds&quot;)</code></pre>
<p>Export the cluster identity vector. It will be included in the <em><a href="https://github.com/kevinrue/hancock">hancock</a></em> package, and mapped using the dummy cell names defined at the start of this notebook.</p>
<pre class="r"><code>ident &lt;- Idents(pbmc)
names(ident) &lt;- colnames(pbmc)
saveRDS(ident, &quot;pbmc3k.ident.rds&quot;)</code></pre>
</div>
<div id="see-also" class="section level1">
<h1>See also</h1>
<ul>
<li><a href="1-proportion_signature.html">Applying Gene Signatures to the Seurat PBMC 3k Tutorial</a></li>
<li><a href="2-learn-signatures.html">Learning Gene Signatures from the Seurat PBMC 3k Tutorial</a></li>
</ul>
<button onclick="topFunction()" id="myBtn" title="Go to top">
Back to top
</button>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
